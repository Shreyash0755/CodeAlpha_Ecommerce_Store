<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PrimeCart</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>

<header class="navbar">
  <h1 class="logo">PrimeCart</h1>
  <input type="text" placeholder="Search products..." />
  <div class="nav-actions" id="navActions"></div>

    <a href="pages/login.html">Login</a>

    <a href="pages/cart.html">Cart</a>

    <a href="pages/orders.html">My Orders</a>

  </div>
</header>

<main class="container">
  <h2>Latest Products</h2>

  <div class="product-grid">
    <div class="product-card">
      <img src="https://via.placeholder.com/300" />
      <h3>Product Name</h3>
      <p class="price">â‚¹999</p>
      <a href="pages/product.html?id=${p._id}">
         <button>View Details</button>
      </a>

  </div>
  </div>
</main>
<script src="js/app.js"></script>
<script>
  document.querySelector("form").addEventListener("submit", async e => {
    e.preventDefault();

    const email = document.querySelector("input[type=email]").value;
    const password = document.querySelector("input[type=password]").value;

    const res = await fetch("http://localhost:5000/api/auth/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password })
    });

    const data = await res.json();

    if (res.ok) {
      localStorage.setItem("token", data.token);
      localStorage.setItem("user", JSON.stringify(data.user));
      window.location.href = "../index.html";
    } else {
      alert(data.message);
    }
  });
</script>
<script>
  const nav = document.getElementById("navActions");

  if (isLoggedIn()) {
    const user = getUser();
    nav.innerHTML = `
      <span>Hi, ${user?.name || "User"}</span>
      <a href="pages/orders.html">My Orders</a>
      <button onclick="logout()">Logout</button>
    `;
  } else {
    nav.innerHTML = `
      <a href="pages/login.html">Login</a>
    `;
  }
</script>

</body>
</html>
