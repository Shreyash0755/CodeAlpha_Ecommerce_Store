<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Checkout</title>
  <link rel="stylesheet" href="../css/style.css" />
</head>
<body>

<header class="navbar">
  <h1 class="logo">PrimeCart</h1>
  <div class="nav-actions">
    <a href="../index.html">Home</a>
    <a href="cart.html">Cart</a>
    <a href="orders.html">My Orders</a>

  </div>
</header>

<main class="container checkout-page">
  <h2>Checkout</h2>

  <div class="checkout-wrapper">
    <form class="checkout-form">
      <h3>Shipping Details</h3>

      <input type="text" placeholder="Full Name" required />
      <input type="email" placeholder="Email" required />
      <input type="text" placeholder="Address" required />
      <input type="text" placeholder="City" required />
      <input type="text" placeholder="Pincode" required />

      <button type="submit" class="primary-btn full">Place Order</button>
    </form>

    <div class="order-summary">
      <h3>Order Summary</h3>
      <div class="summary-row">
        <span>Total</span>
        <span id="orderTotal">₹0</span>
      </div>
    </div>
  </div>
</main>

<script src="../js/cart.js"></script>
<script>
  const USER_ID = "TEMP_USER_ID"; // replace after auth integration

  document.getElementById("orderTotal").innerText = "₹" + cartTotal();

  document.querySelector(".checkout-form").addEventListener("submit", async e => {
    e.preventDefault();

    const items = getCart().map(i => ({
      productId: i.id,
      name: i.name,
      price: i.price,
      qty: i.qty
    }));

    const res = await fetch("http://localhost:5000/api/orders", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        userId: USER_ID,
        items,
        total: cartTotal()
      })
    });

    if (res.ok) {
      localStorage.removeItem("cart_items");
      alert("Order placed successfully!");
      window.location.href = "orders.html";
    }
  });
</script>


</body>
</html>
